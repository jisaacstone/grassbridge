-- explicit CREATE TABLE is needed for datatypes, which grass complains about --
CREATE TABLE IF NOT EXISTS "bridges"(
  "STATE_CODE_001" TEXT,
  "STRUCTURE_NUMBER_008" TEXT,
  "RECORD_TYPE_005A" TEXT,
  "ROUTE_PREFIX_005B" TEXT,
  "SERVICE_LEVEL_005C" TEXT,
  "ROUTE_NUMBER_005D" TEXT,
  "DIRECTION_005E" TEXT,
  "HIGHWAY_DISTRICT_002" TEXT,
  "COUNTY_CODE_003" TEXT,
  "PLACE_CODE_004" TEXT,
  "FEATURES_DESC_006A" TEXT,
  "CRITICAL_FACILITY_006B" TEXT,
  "FACILITY_CARRIED_007" TEXT,
  "LOCATION_009" TEXT,
  "MIN_VERT_CLR_010" TEXT,
  "KILOPOINT_011" TEXT,
  "BASE_HWY_NETWORK_012" TEXT,
  "LRS_INV_ROUTE_013A" TEXT,
  "SUBROUTE_NO_013B" TEXT,
  "LAT_016" TEXT,
  "LONG_017" TEXT,
  "DETOUR_KILOS_019" TEXT,
  "TOLL_020" TEXT,
  "MAINTENANCE_021" TEXT,
  "OWNER_022" TEXT,
  "FUNCTIONAL_CLASS_026" TEXT,
  "YEAR_BUILT_027" INTEGER,
  "TRAFFIC_LANES_ON_028A" INTEGER,
  "TRAFFIC_LANES_UND_028B" INTEGER,
  "ADT_029" INTEGER,
  "YEAR_ADT_030" INTEGER,
  "DESIGN_LOAD_031" INTEGER,
  "APPR_WIDTH_MT_032" TEXT,
  "MEDIAN_CODE_033" TEXT,
  "DEGREES_SKEW_034" INTEGER,
  "STRUCTURE_FLARED_035" TEXT,
  "RAILINGS_036A" TEXT,
  "TRANSITIONS_036B" TEXT,
  "APPR_RAIL_036C" TEXT,
  "APPR_RAIL_END_036D" TEXT,
  "HISTORY_037" TEXT,
  "NAVIGATION_038" TEXT,
  "NAV_VERT_CLR_MT_039" TEXT,
  "NAV_HORR_CLR_MT_040" TEXT,
  "OPEN_CLOSED_POSTED_041" TEXT,
  "SERVICE_ON_042A" TEXT,
  "SERVICE_UND_042B" TEXT,
  "STRUCTURE_KIND_043A" TEXT,
  "STRUCTURE_TYPE_043B" TEXT,
  "APPR_KIND_044A" TEXT,
  "APPR_TYPE_044B" TEXT,
  "MAIN_UNIT_SPANS_045" TEXT,
  "APPR_SPANS_046" TEXT,
  "HORR_CLR_MT_047" TEXT,
  "MAX_SPAN_LEN_MT_048" TEXT,
  "STRUCTURE_LEN_MT_049" TEXT,
  "LEFT_CURB_MT_050A" TEXT,
  "RIGHT_CURB_MT_050B" TEXT,
  "ROADWAY_WIDTH_MT_051" INTEGER,
  "DECK_WIDTH_MT_052" INTEGER,
  "VERT_CLR_OVER_MT_053" TEXT,
  "VERT_CLR_UND_REF_054A" TEXT,
  "VERT_CLR_UND_054B" TEXT,
  "LAT_UND_REF_055A" TEXT,
  "LAT_UND_MT_055B" TEXT,
  "LEFT_LAT_UND_MT_056" TEXT,
  "DECK_COND_058" TEXT,
  "SUPERSTRUCTURE_COND_059" TEXT,
  "SUBSTRUCTURE_COND_060" TEXT,
  "CHANNEL_COND_061" TEXT,
  "CULVERT_COND_062" TEXT,
  "OPR_RATING_METH_063" TEXT,
  "OPERATING_RATING_064" TEXT,
  "INV_RATING_METH_065" TEXT,
  "INVENTORY_RATING_066" TEXT,
  "STRUCTURAL_EVAL_067" TEXT,
  "DECK_GEOMETRY_EVAL_068" TEXT,
  "UNDCLRENCE_EVAL_069" TEXT,
  "POSTING_EVAL_070" TEXT,
  "WATERWAY_EVAL_071" TEXT,
  "APPR_ROAD_EVAL_072" TEXT,
  "WORK_PROPOSED_075A" TEXT,
  "WORK_DONE_BY_075B" TEXT,
  "IMP_LEN_MT_076" TEXT,
  "DATE_OF_INSPECT_090" INTEGER,
  "INSPECT_FREQ_MONTHS_091" TEXT,
  "FRACTURE_092A" TEXT,
  "UNDWATER_LOOK_SEE_092B" TEXT,
  "SPEC_INSPECT_092C" TEXT,
  "FRACTURE_LAST_DATE_093A" TEXT,
  "UNDWATER_LAST_DATE_093B" TEXT,
  "SPEC_LAST_DATE_093C" TEXT,
  "BRIDGE_IMP_COST_094" TEXT,
  "ROADWAY_IMP_COST_095" TEXT,
  "TOTAL_IMP_COST_096" TEXT,
  "YEAR_OF_IMP_097" TEXT,
  "OTHER_STATE_CODE_098A" TEXT,
  "OTHER_STATE_PCNT_098B" TEXT,
  "OTHR_STATE_STRUC_NO_099" TEXT,
  "STRAHNET_HIGHWAY_100" TEXT,
  "PARALLEL_STRUCTURE_101" TEXT,
  "TRAFFIC_DIRECTION_102" TEXT,
  "TEMP_STRUCTURE_103" TEXT,
  "HIGHWAY_SYSTEM_104" TEXT,
  "FEDERAL_LANDS_105" TEXT,
  "YEAR_RECONSTRUCTED_106" TEXT,
  "DECK_STRUCTURE_TYPE_107" TEXT,
  "SURFACE_TYPE_108A" TEXT,
  "MEMBRANE_TYPE_108B" TEXT,
  "DECK_PROTECTION_108C" TEXT,
  "PERCENT_ADT_TRUCK_109" TEXT,
  "NATIONAL_NETWORK_110" TEXT,
  "PIER_PROTECTION_111" TEXT,
  "BRIDGE_LEN_IND_112" TEXT,
  "SCOUR_CRITICAL_113" TEXT,
  "FUTURE_ADT_114" TEXT,
  "YEAR_OF_FUTURE_ADT_115" TEXT,
  "MIN_NAV_CLR_MT_116" TEXT,
  "FED_AGENCY" TEXT,
  "SUBMITTED_BY" TEXT,
  "BRIDGE_CONDITION" TEXT,
  "LOWEST_RATING" TEXT,
  "DECK_AREA" INTEGER
, latitude REAL, longitude REAL);
.import --skip 1 --csv datasets/PA22.csv bridges
-- use decimal lat/lng --
UPDATE bridges
SET latitude = CAST(SUBSTR(LAT_016, 1, 2) AS REAL) +
               CAST(SUBSTR(LAT_016, 3, 2) AS REAL) / 60 +
               CAST(SUBSTR(LAT_016, 5) AS REAL) / 360000,
    longitude = -(CAST(SUBSTR(LONG_017, 1, 3) AS REAL) +
                  CAST(SUBSTR(LONG_017, 4, 2) AS REAL) / 60 +
                  CAST(SUBSTR(LONG_017, 6) AS REAL) / 360000);
